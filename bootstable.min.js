"use strict";var params=null,colsEdi=null,newColHtml='<div class="btn-group float-end"><button id="bEdit" type="button" class="btn btn-sm btn-primary" onclick="butRowEdit(this);"><span class="fa fa-pencil" > </span></button><button id="bElim" type="button" class="btn btn-sm btn-danger" onclick="butRowDelete(this);"><span class="fa fa-trash" > </span></button><button id="bAcep" type="button" class="btn btn-sm btn-success" style="display:none;" onclick="butRowAcep(this);"><span class="fa fa-check" > </span></button><button id="bCanc" type="button" class="btn btn-sm btn-warning" style="display:none;" onclick="butRowCancel(this);"><span class="fa fa-remove" > </span></button></div>',newColHtml2='<div class="btn-group float-end"><button id="bEdit" type="button" class="btn btn-sm btn-primary" onclick="butRowEdit(this);"><span class="fa fa-pencil" > ✎ </span></button><button id="bElim" type="button" class="btn btn-sm btn-danger" onclick="butRowDelete(this);"><span class="fa fa-trash" > X </span></button><button id="bAcep" type="button" class="btn btn-sm btn-success" style="display:none;" onclick="butRowAcep(this);"><span class="fa fa-check" > ✓ </span></button><button id="bCanc" type="button" class="btn btn-sm btn-warning" style="display:none;" onclick="butRowCancel(this);"><span class="fa fa-remove" > → </span></button></div>',colEdicHtml=document.createElement("td");function SetEditable(t,e){params=_extend({columnsEd:null,$addButton:null,bootstrap:!0,defaultValues:[],addButtonEdit:!0,onEdit:function(){},onBeforeDelete:function(){},onDelete:function(){},onAdd:function(){}},e);const n=document.createElement("th");if(n.setAttribute("name","buttons"),params.$addButton){const o=document.createElement("button");o.setAttribute("class","btn btn-success"),o.id(params.$addButton),o.addEventListener("onclick",()=>{params.addButtonEdit?rowAddNewAndEdit(t,params.defaultValues):rowAddNew(t)});const l=document.createElement("i");l.setAttribute("fa fa-plus"),o.appendChild(l),n.appendChild(o)}document.querySelectorAll(`#${t} thead tr`)[0].appendChild(n),params.bootstrap||(colEdicHtml.innerHTML=`<td name="buttons">${newColHtml2}</td>`);for(const a of document.querySelectorAll(`#${t} tbody tr`))a.appendChild(colEdicHtml);null!=params.columnsEd&&(colsEdi=params.columnsEd.split(","))}function IterarCamposEdit(t,e){var n=0;for(const o of t){if(n++,"buttons"==o.getAttribute("name"))return;if(!IsEditable(n-1))return;e(o)}}function IsEditable(t){if(null==colsEdi)return!0;for(var e=0;e<colsEdi.length;e++)if(t==colsEdi[e])return!0;return!1}function ModoEdicion(t){return"editing"==t.id}function SetButtonsNormal(t){var e;for(e of t.childNodes())switch(e.id){case"bAcep":case"bCanc":e.style.display="none";break;case"bEdit":case"bElim":e.style.display="block"}t.parentNode.parentNode.setAttribute("id","")}function SetButtonsEdit(t){var e;for(e of t.childNodes())switch(e.id){case"bAcep":case"bCanc":e.style.display="block";break;case"bEdit":case"bElim":e.style.display="none"}t.parentNode.parentNode.setAttribute("id","editing")}function butRowAcep(t){var e=t.parentNode.parentNode,n=e.querySelectorAll("td");ModoEdicion(e)&&(IterarCamposEdit(n,function(t){var e=t.value;t.innerHTML=e}),SetButtonsNormal(t),params.onEdit(e))}function butRowCancel(t){var e=t.parentNode.parentNode,n=e.querySelectorAll("td");ModoEdicion(e)&&(IterarCamposEdit(n,function(t){t.querySelectorAll("div").innerHTML="";t.html("")}),SetButtonsNormal(t))}function butRowEdit(t){var e,n=t.parentNode.parentNode,o=n.querySelectorAll("td");ModoEdicion(n)||(e=!1,IterarCamposEdit(o,function(t){t.innerHTML="";t.innerHTML='<div style="display: none;"></div><input class="form-control input-sm"  value="">',e||(t.querySelectorAll("input")[0].focus(),e=!0)}),SetButtonsEdit(t))}function butRowDelete(t){t=t.parentNode.parentNode;params.onBeforeDelete(t),t.remove(),params.onDelete()}function rowAddNew(t,e=[]){var n,o=document.getElementByID(t),t=o.querySelectorAll("thead tr")[0].querySelectorAll("th"),l=0,a=document.createElement("tr");for(const s of t){if("buttons"==s.getAttribute("name"))a.appendChild(colEdicHtml);else{const d=document.createElement("td");l<e.length&&(n=document.createTextNode(e[l]),d.appendChild(n)),a.appendChild(d)}l++}o.querySelectorAll("tbody")[0].appendChild(a),params.onAdd()}function rowAddNewAndEdit(t,e=[]){rowAddNew(t,e),butRowEdit(document.getElementById(t).querySelectorAll("tbody")[0].lastChild.getElementByID("bEdit"))}function TableToCSV(t,e){var n,o="",t=document.getElementById(t);for(const l of t.querySelectorAll("tbody tr"))ModoEdicion(l)&&(n=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),l.getElementByID("bAcep").dispatchEvent(n));o="";for(const a of t.querySelectorAll("td"))"buttons"!=a.getAttribute("name")&&(o=o+a.innerHTML+e);return(o=""!=o?o.substr(0,o.length-e.length):o)+"\n"}function TableToJson(t){var e=[];const n=document.getElementByID(t);var o=[];for(const a of n.querySelectorAll("thead tr th"))o.push(a.innerHTML);for(const s of n.querySelectorAll("tbody tr")){var l=0;e.push({});for(const d of s.querySelectorAll("td"))e[e.length-1][o[l]]=d.innerHTML,l++}return JSON.Stringify(e)}function _extend(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}colEdicHtml.setAttribute("name","buttons"),colEdicHtml.innerHTML=newColHtml;